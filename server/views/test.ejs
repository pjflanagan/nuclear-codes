<!doctype html>
<html>

<head>
  <%- include('partials/head.ejs') -%>
</head>

<!-- TODO: password protect this page on PRD somehow -->

<body ng-app="nuclear-codes-test">
  <div class="controller" ng-controller="testController" ng-init="init()">

    <!-- HEADER -->
    <div class="header">
      <h1>nuclear-codes-test</h1>
      <div class="form-row">
        <label>Game Room Name:</label>
        <input type="text" ng-model="state.roomName" />
        <label>Players:</label>
        <input type="number" ng-model="state.playerCount" />
        <button ng-click="addRoom()">Start Test Room</button>
        <button ng-click="addAutoRoom()">Start Auto Test Room</button>
        <!-- TODO: plays 100 auto games, randomly add players randomly drop players, close out the room at the end -->
        <button ng-click="addFullAutoRoom()">Start Full Auto Test Room</button>
      </div>
    </div>

    <!-- CONTAINER -->
    <div class="container">
      <div id="gamerooms">

        <!-- GAMEROOM -->
        <div class="room" ng-repeat="(i, room) in state.rooms">

          <!-- ROOM INFO -->
          <a href="{{room.roomURL}}" target="_blank">
            <h2>{{ room.roomName }}</h2>
          </a>
          <div class="form-row">
            <!-- TODO: make this work -->
            <label>Add Player Name</label>
            <input type="text" />
            <button>Add Player To Game</button>
          </div>
          <div class="form-row">
            <button ng-click="room.sendReadyUp()">Send Ready Up All</button>
            <button ng-click="room.sendRoomChoices()">Send Room Choice All</button>
            <button ng-click="room.sendCode(true)">Send Correct Code</button>
            <button ng-click="room.sendCode(false)">Send Incorrect Code</button>
          </div>

          <!-- PLAYERS -->
          <div class="players">
            <div class="player" ng-class="player.isSpy() ? 'spy' : ''" ng-repeat="(j, player) in room.players">
              <h3>{{ player.playerName }}</h3>
              <p class="data">{{ player.slide }}</p>

              <!-- Ready Up -->
              <div class="form-row">
                <button ng-click="player.sendReadyUp()">Send Ready Up</button>
              </div>

              <!-- Room Choice -->
              <div class="form-row">
                <label>Room Number:</label>
                <input type="number" min="0" max="4" val="0" ng-model="player.response.roomID" />
                <button ng-click="player.sendRoomChoice()">Send Room Choice</button>
              </div>

              <!-- Enter Code -->
              <div class="form-row">
                <label>Code:</label>
                <button ng-click="player.sendEnterCode(true)">Send Correct Code</button>
                <button ng-click="player.sendEnterCode(false)">Send Incorrect Code</button>
              </div>

              <!-- Disconnect -->
              <div class="form-row">
                <button ng-click="player.disconnectPlayer()">Disconnect</button>
              </div>

              <!-- TODO: Reconnect -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/assets/packages/angular.min.js"></script>

  <script src="/assets/script.js" type="module"></script>
  <script src="/reload/reload.js"></script>

</body>

</html>